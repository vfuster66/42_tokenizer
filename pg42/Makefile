# DÃ©finition des rÃ©pertoires
BACKEND_DIR=code
FRONTEND_DIR=code/frontend

# DÃ©finition des commandes
PNPM=pnpm
HARDHAT_CMD=$(PNPM) exec hardhat run scripts/full-test.ts --network bscTestnet
DEV_CMD=$(PNPM) dev

# Commande pour installer toutes les dÃ©pendances
.PHONY: install
install:
	@echo "ðŸš€ Installation des dÃ©pendances dans $(BACKEND_DIR)/ et $(FRONTEND_DIR)/ ..."
	@cd $(BACKEND_DIR) && $(PNPM) install
	@cd $(FRONTEND_DIR) && $(PNPM) install
	@echo "âœ… Installation terminÃ©e !"

# Commande pour dÃ©marrer le projet
.PHONY: run
run:
	@echo "ðŸš€ Lancement du serveur de dÃ©veloppement..."
	@cd $(FRONTEND_DIR) && $(DEV_CMD) &
	@echo "âœ… Serveur en cours d'exÃ©cution ! AccÃ©dez Ã  l'application sur : http://localhost:3000"

# Commande pour exÃ©cuter les tests Hardhat
.PHONY: test
test:
	@echo "ðŸš€ ExÃ©cution des tests avec Hardhat..."
	@cd $(BACKEND_DIR) && $(HARDHAT_CMD)
	@echo "âœ… Tests terminÃ©s !"

# Commande pour nettoyer les fichiers node_modules et pnpm store
.PHONY: clean
clean:
	@echo "ðŸ§¹ Nettoyage des dÃ©pendances..."
	@rm -rf $(BACKEND_DIR)/node_modules $(FRONTEND_DIR)/node_modules
	@rm -rf ~/.pnpm-store
	@echo "âœ… Nettoyage terminÃ© !"

# Commande pour tout rÃ©installer
.PHONY: reinstall
reinstall: clean install

# Aide pour voir les commandes disponibles
.PHONY: help
help:
	@echo "ðŸ“œ Commandes disponibles :"
	@echo "  make install      â†’ Installe les dÃ©pendances"
	@echo "  make run          â†’ DÃ©marre le frontend et affiche l'URL"
	@echo "  make test         â†’ ExÃ©cute les tests Hardhat"
	@echo "  make clean        â†’ Supprime les dÃ©pendances"
	@echo "  make reinstall    â†’ Nettoie et rÃ©installe toutes les dÃ©pendances"
	@echo "  make help         â†’ Affiche cette aide"
